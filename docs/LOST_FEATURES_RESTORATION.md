# 失われた機能の復元計画 - Lost Features Restoration Plan

## 📋 概要 / Overview

このドキュメントは、mile-comparison-appで失われた機能を記録し、復元の進捗を管理するためのものです。
地域別空港表示機能の消失を契機に作成されました。

## ✅ 復元完了済み機能 / Restored Features

### 1. 地域別空港表示機能 ✅ COMPLETED
- **説明**: 空港選択時に地域別（関東、関西、中部、北海道、東北、中国、四国、九州、沖縄、アジア、北米、ヨーロッパ、オセアニア）でグループ化表示
- **復元状況**: 完了
- **実装ファイル**:
  - `src/constants/index.ts` - 完全な空港リストと地域メタデータ
  - `src/types/index.ts` - Airport型にregionプロパティ追加
  - `src/data/index.ts` - 地域別に整理された完全な空港データ
  - `src/components/SearchForm.tsx` - 地域別表示機能付きに更新
  - `src/components/EnhancedSearchForm.tsx` - 拡張版検索フォーム（高機能版）
  - `src/components/AdvancedSearchForm.tsx` - アドバンス版検索フォーム
- **復元日**: 2024年12月20日

### 2. 包括的空港リスト ✅ COMPLETED
- **説明**: 国内外の主要空港を網羅したリスト
- **復元状況**: 完了
- **実装内容**:
  - 国内空港: 全地域（北海道、東北、関東、中部、関西、中国、四国、九州、沖縄）
  - 国際空港: アジア、北米、ヨーロッパ、オセアニア主要都市
  - 各空港の詳細情報（コード、都市名、空港名、地域）
- **復元日**: 2024年12月20日

### 3. 型安全性の向上 ✅ COMPLETED
- **説明**: Airport型の拡張とregionプロパティの追加
- **復元状況**: 完了
- **実装詳細**: TypeScriptの型定義を更新し、地域情報の型安全性を確保
- **復元日**: 2024年12月20日

## 🔄 復元進行中の機能 / Features in Progress

### 4. 人気ルートプリセット機能 🔄 IN PROGRESS
- **説明**: よく使われるルートのワンクリック設定機能
- **復元状況**: 部分的に完了（EnhancedSearchFormで実装済み）
- **実装済み**:
  - 国内線・国際線の人気ルート分類表示
  - ワンクリックでの出発地・到着地設定
- **残作業**: 
  - メインのSearchFormへの統合
  - ユーザー使用統計に基づくルート更新機能
- **優先度**: 中

### 5. 検索履歴機能 🔄 IN PROGRESS
- **説明**: 過去の検索履歴の保存・表示・再利用機能
- **復元状況**: EnhancedSearchFormで基本実装済み
- **実装済み**:
  - ローカルストレージでの履歴保存
  - 最近の検索の表示
  - ワンクリックでの履歴からの再検索
- **残作業**: 
  - 履歴の詳細管理（削除、並び替え）
  - メインコンポーネントへの統合
- **優先度**: 中

## 🔍 復元予定の機能 / Features Planned for Restoration

### 6. 高度な検索フィルター機能 📋 PLANNED
- **説明**: 座席クラス、乗り継ぎ有無、航空会社指定などの詳細フィルター
- **復元状況**: 未着手
- **計画内容**:
  - ビジネス/ファーストクラス検索オプション
  - 乗り継ぎ便の含有/除外設定
  - 特定航空会社での絞り込み
  - 日程の幅指定（±数日）
- **必要ファイル**: 
  - `src/components/SearchFilters.tsx` (新規作成)
  - `src/types/index.ts` (FilterOptions型追加)
  - `src/services/flightService.ts` (フィルター処理追加)
- **優先度**: 高

### 7. マイル表更新アラート機能 📋 PLANNED
- **説明**: 航空会社のマイル表変更時の自動通知機能
- **復元状況**: 部分実装あり（MileUpdateAlert.tsxとして別途実装済み）
- **統合作業**:
  - メインアプリケーションへの統合
  - ユーザー設定による通知のON/OFF
  - 特定ルートのウォッチリスト機能
- **優先度**: 高

### 8. お気に入りルート機能 📋 PLANNED
- **説明**: よく使うルートをお気に入り登録・管理する機能
- **復元状況**: 未着手
- **計画内容**:
  - ルートのお気に入り登録
  - お気に入りリストの管理
  - お気に入りからの素早い検索
- **必要ファイル**: 
  - `src/components/FavoriteRoutes.tsx` (新規作成)
  - `src/hooks/useFavorites.ts` (新規作成)
- **優先度**: 中

### 9. 価格履歴グラフ機能 📋 PLANNED
- **説明**: 特定ルートのマイル要件数の推移をグラフ表示
- **復元状況**: 未着手
- **計画内容**:
  - 過去のマイル要件数データの収集
  - チャートライブラリを使った可視化
  - トレンド分析機能
- **必要ファイル**: 
  - `src/components/PriceHistoryChart.tsx` (新規作成)
  - `src/services/priceHistoryService.ts` (新規作成)
- **優先度**: 低

### 10. 多言語対応機能 📋 PLANNED
- **説明**: 英語・韓国語・中国語等への多言語対応
- **復元状況**: 未着手
- **計画内容**:
  - i18n設定
  - 翻訳ファイルの作成
  - 言語切り替えUI
- **必要ファイル**: 
  - `src/i18n/` (新規ディレクトリ)
  - `src/hooks/useTranslation.ts` (新規作成)
- **優先度**: 低

## 🛠️ 技術的改善事項 / Technical Improvements

### A. パフォーマンス最適化 🔧 TECH DEBT
- **内容**: 
  - 空港リストの仮想化
  - 検索結果のページネーション
  - 画像の遅延読み込み
- **優先度**: 中

### B. テストカバレッジの向上 🔧 TECH DEBT
- **内容**:
  - ユニットテストの追加
  - E2Eテストの実装
  - コンポーネントテストの充実
- **優先度**: 高

### C. アクセシビリティの向上 🔧 TECH DEBT
- **内容**:
  - キーボードナビゲーション
  - スクリーンリーダー対応
  - カラーコントラストの改善
- **優先度**: 中

## 📅 復元タイムライン / Restoration Timeline

### フェーズ1: 基本機能復元 (完了)
- ✅ 地域別空港表示
- ✅ 包括的空港リスト
- ✅ 型安全性向上

### フェーズ2: 検索機能強化 (進行中)
- 🔄 人気ルートプリセット
- 🔄 検索履歴機能
- 📋 高度な検索フィルター

### フェーズ3: ユーザー体験向上 (計画中)
- 📋 マイル表更新アラート統合
- 📋 お気に入りルート機能
- 📋 価格履歴グラフ

### フェーズ4: 高度な機能 (将来計画)
- 📋 多言語対応
- 🔧 パフォーマンス最適化
- 🔧 テストカバレッジ向上

## 📝 注意事項 / Notes

1. **データの整合性**: 新機能追加時は既存データとの整合性を必ず確認
2. **パフォーマンス**: 空港リストが大きくなったため、パフォーマンスに注意
3. **型安全性**: TypeScriptの型定義を常に最新に保つ
4. **ユーザビリティ**: 機能追加時はユーザビリティテストを実施
5. **バックアップ**: 重要な変更前には必ずバックアップを作成

## 🔗 関連リンク / Related Links

- [プロジェクトルート](../)
- [コンポーネント一覧](../src/components/)
- [型定義](../src/types/)
- [定数定義](../src/constants/)

---

**最終更新**: 2024年12月20日  
**作成者**: GitHub Copilot  
**ステータス**: 継続メンテナンス中

## 📂 失われた主要機能

### 1. 包括的な空港リスト（地域別分類）
- 関東: HND, NRT, IBR
- 関西: KIX, ITM, UKB
- 中部: NGO, KMQ, TOY, NTQ
- 九州: FUK, KMJ, KOJ, OIT, NGS, ASJ, TNE
- 四国: TAK, KCZ, MYJ
- 中国: HIJ, UBJ, OKJ, IWJ, TTJ
- 東北: SDJ, AOJ, AXT, SHM, HNA, GAJ, ONJ
- 北海道: CTS, AKJ, HKD, OBO, KUH, MMB, RIS, SHB, WKJ
- 沖縄: OKA, MMY, ISG, ASJ, AGJ, KJP, SHI

### 2. 地域別UI表示機能
- ドロップダウンでの地域カテゴリ分け
- 地域ヘッダー付きの見やすい空港選択
- 人気空港の優先表示

### 3. 国際線空港
- アジア: ICN, TPE, BKK, SIN, HKG, PEK, PVG, CAN, KUL, CGK, MNL
- 北米: LAX, SFO, SEA, LAS, PHX, DEN, DFW, ORD, JFK, LGA, EWR, IAD, BOS, MIA
- ヨーロッパ: LHR, LGW, CDG, ORY, FRA, MUC, AMS, FCO, ARN, CPH, ZUR, VIE
- オセアニア: SYD, MEL, BNE, AKL, CHC

### 4. 高度な検索機能
- 複数空港選択
- 柔軟な日程検索
- マイル価値計算
- シーズン別料金表示

### 5. UI/UX機能
- タブナビゲーション
- レスポンシブデザイン
- 人気ルートプリセット
- 検索履歴

## 🔧 復元計画

### Phase 1: 包括的空港リスト復元
1. 地域別空港データの再構築
2. 国際線空港の追加
3. 空港検索・フィルター機能

### Phase 2: UI/UX機能復元
1. 地域別表示コンポーネント
2. 人気ルートプリセット
3. 検索体験の改善

### Phase 3: 高度機能復元
1. マルチ空港検索
2. 価格比較機能
3. アラート機能

## 📁 バックアップ場所
- /backups/lost-features/
- /docs/original-features.md
