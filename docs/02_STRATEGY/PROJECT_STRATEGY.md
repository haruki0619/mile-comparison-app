# マイルコンパス - プロジェクト戦略・実装ガイド

## 📋 目次
1. [プロジェクト概要](#プロジェクト概要)
2. [現在のアーキテクチャ](#現在のアーキテクチャ)
3. [実装ロードマップ](#実装ロードマップ)
4. [API戦略](#api戦略)
5. [収益化戦略](#収益化戦略)
6. [UI/UX改善記録](#uiux改善記録)
7. [技術的詳細](#技術的詳細)

## 🎯 プロジェクト概要

### ビジョン
航空券とマイル交換の最適化を支援する日本最大級のマイル比較プラットフォーム

### 現在の状況（2025年1月更新）
- **技術スタック**: Next.js 15 + TypeScript + Tailwind CSS
- **機能状況**: 国内線・国際線・アライアンス対応の包括的マイル比較システム
- **品質状況**: モジュール分割・型安全性・UI安全性強化完了
- **文書化状況**: 設計書・技術ドキュメント・品質保証プロセス確立完了
- **UI/UX**: 統合ヘッダー・自動スクロール・価値分析表示等の体験改善完了
- **データ**: 実データベース（JAL・ANA 2024-2025年公式チャート + 海外航空会社対応）

### 🌟 最新追加機能
1. **国際線完全対応**: 主要10路線・燃油サーチャージ込み計算
2. **海外プログラム**: United・American・Delta・British Airways・Singapore・Emirates
3. **アライアンス戦略**: スターアライアンス・ワンワールド・スカイチーム
4. **マイル価値分析**: 効率評価・推奨アルゴリズム・節約額表示
5. **AI支援ツール**: 包括的データ収集プロンプト・分析ガイド

## 🏗️ 現在のアーキテクチャ

### ファイル構成
```
src/
├── app/                    # Next.js App Router
│   ├── page.tsx           # メインページ
│   ├── layout.tsx         # レイアウト
│   └── api/               # APIルート
├── components/            # UIコンポーネント
│   ├── SearchResults.tsx  # 検索結果（統合ヘッダー実装済み）
│   ├── UnifiedMileComparison.tsx  # 統合マイル比較
│   ├── ui/               # 基本UIコンポーネント
│   └── features/         # 機能別コンポーネント
├── services/             # API統合
│   └── apiClients/       # APIクライアント
│       ├── rakutenClient.ts    # 楽天API
│       ├── amadeusClient.ts    # Amadeus API
│       └── skyscannerClient.ts # Skyscanner API
├── types/                # TypeScript型定義
├── utils/                # ユーティリティ関数
└── data/                 # 静的データ（現在使用中）
```

### 技術特徴
- **レスポンシブデザイン**: モバイルファースト
- **アクセシビリティ**: WCAG AA準拠
- **パフォーマンス**: Next.js 15最適化
- **型安全性**: TypeScript完全対応
- **国際対応**: 多言語・多通貨サポート準備
- **リアルタイム**: マイルチャート更新・価格変動対応

## 📅 実装ロードマップ

### ✅ Phase 1: 基盤完成 (完了)
**2025年7月達成済み**

#### 1.1 データベース構築 ✅
- [x] JAL・ANA 2024-2025年最新チャート実装
- [x] 国際線10路線・燃油サーチャージ対応
- [x] LCC各社（Peach・Jetstar・Spring・Vanilla）追加
- [x] 海外航空会社（United・American・Delta等）基盤実装

#### 1.2 計算エンジン ✅
- [x] シーズン変動対応・プレミアムエコノミー・ビジネス計算
- [x] アライアンス特典航空券対応
- [x] マイル価値分析・効率評価機能
- [x] 燃油サーチャージ込み総コスト計算

### 🚀 Phase 2: 機能拡充 (進行中)
**優先度: 高**

#### 2.1 API統合強化
- [x] APIクライアント実装済み
- [ ] 実データ取得・表示
- [ ] エラーハンドリング強化
- [ ] レート制限対応（1000回/日）

#### 1.2 Amadeus API統合
- [x] APIクライアント実装済み
- [ ] 国際線データ取得
- [ ] 複数API結果統合
- [ ] フォールバック機能

### Phase 2: 機能拡充 (2-3ヶ月)
**優先度: 🚀 高**

#### 2.1 マルチマイル対応
```typescript
interface AdvancedMileSearch {
  airlines: ('ANA' | 'JAL' | 'UA' | 'Delta' | 'AA')[];
  travelClass: 'economy' | 'business' | 'first';
  flexibility: 'exact' | 'flexible_dates';
}
```

#### 2.2 マイル価値分析機能
- マイル価値計算エンジン
- 現金vs.マイル比較
- 最適ルート提案

### Phase 3: 収益化実装 (1-2ヶ月)
**優先度: 💰 中**

#### 3.1 アフィリエイト収益
- クレジットカード紹介
- 航空券予約リンク
- ホテル・レンタカー連携

#### 3.2 プレミアム機能
- 高度な分析機能
- アラート機能
- API優先アクセス

## 🔌 API戦略

### 現在利用可能なAPI

#### 1. 楽天トラベルAPI ⭐ **メイン**
```javascript
const rakutenAPI = {
  status: '利用可能',
  cost: '無料（1000回/日）',
  coverage: '国内線・ホテル',
  registration: '完了済み'
};
```

#### 2. Amadeus API ⭐ **国際線メイン**
```javascript
const amadeusAPI = {
  status: '利用可能',
  cost: '無料枠有り',
  coverage: '国際線・多機能',
  registration: '完了済み'
};
```

#### 3. Skyscanner API ❌ **利用不可**
```javascript
const skyscannerAPI = {
  status: '利用不可',
  reason: '個人開発者・小規模利用不可',
  alternative: '楽天・Amadeus併用'
};
```

### API統合戦略
1. **デュアルAPI戦略**: 楽天（国内）+ Amadeus（国際）
2. **フォールバック機能**: API障害時の代替処理
3. **キャッシュ戦略**: レート制限対応
4. **エラーハンドリング**: ユーザー体験維持

## 💰 収益化戦略

### 短期収益（6ヶ月以内）
1. **アフィリエイト収益**
   - クレジットカード紹介: 月10-50万円
   - 航空券予約手数料: 月5-20万円
   - ホテル予約: 月3-15万円

2. **広告収益**
   - Google AdSense: 月2-10万円
   - 航空会社広告: 月5-25万円

### 中期収益（1年以内）
1. **プレミアム会員**
   - 月額980円
   - 高度分析・アラート機能
   - 目標: 500名→月49万円

2. **B2B API提供**
   - 旅行代理店向け
   - 月額5-20万円

### 長期収益（2年以内）
1. **マイル売買仲介**
   - プラットフォーム手数料
   - 月100-500万円

2. **企業向けコンサル**
   - マイル戦略アドバイス
   - 案件単価50-200万円

## 🎨 UI/UX改善記録

### 2025年7月14日実装済み

#### 1. 検索結果ヘッダー統合
**問題**: 検索結果情報が複数ゾーンに分散
**解決**: 統合ヘッダーで一元表示
```tsx
// 統合された情報
- 検索結果タイトル（「検索結果」）
- 路線情報（ITM → HND | 2025-07-31）
- 件数表示（「見つかりました 10件」）
- 詳細路線情報（大阪 (ITM) → 東京 (HND)）
- シーズン情報（レギュラーシーズン）
- 日付・距離情報（2025年7月31日(木) 400km）
```

#### 2. 自動スクロール機能
**問題**: 検索後、手動スクロールが必要
**解決**: 人間らしい自動スクロール実装
```typescript
// 実装特徴
- 距離に応じた動的速度（800ms〜1500ms）
- ease-out イージング関数
- ヘッダー高さ考慮（80px余白）
- requestAnimationFrame使用
```

#### 3. 人気ルートデフォルト変更
**問題**: 人気ルートが国際線優先で、国内利用者のニーズとミスマッチ
**解決**: 国内線を優先デフォルトに変更
```typescript
// 変更点
- EnhancedSearchFormのデフォルト: 'international' → 'domestic'
- SearchFormの人気ルート: 国際線 → 国内線（東京-大阪、東京-沖縄等）
- DynamicMileComparisonの目的地: 国際都市 → 国内都市優先
```

### 今後の改善予定
1. **モバイル体験向上**
2. **アクセシビリティ強化**
3. **パフォーマンス最適化**
4. **多言語対応**

## 🔧 技術的詳細

### 開発環境
- **Node.js**: 18+
- **Next.js**: 15.3.5
- **TypeScript**: 5+
- **Tailwind CSS**: 3+

### 品質保証
- **ESLint**: コード品質
- **TypeScript**: 型安全性
- **Responsive**: モバイル対応
- **Accessibility**: WCAG AA準拠

### デプロイメント
- **Platform**: Vercel
- **Domain**: 独自ドメイン予定
- **CDN**: Vercel Edge Network
- **Analytics**: Vercel Analytics

## 📊 成功指標（KPI）

### ユーザー指標
- **MAU**: 月間アクティブユーザー
- **検索数**: 月間検索実行数
- **滞在時間**: 平均セッション時間
- **コンバージョン率**: アフィリエイト転換率

### 技術指標
- **ページ速度**: Core Web Vitals
- **エラー率**: API・システムエラー
- **可用性**: アップタイム 99.9%
- **レスポンス時間**: 2秒以内

### 収益指標
- **月間収益**: アフィリエイト・広告
- **ユーザー単価**: ARPU
- **成長率**: 月次成長率
- **損益分岐**: 6ヶ月以内

## 🚀 次のアクション

### 今週実施予定
1. [ ] 楽天API実データ取得機能実装
2. [ ] エラーハンドリング強化
3. [ ] パフォーマンス最適化

### 今月実施予定
1. [ ] Amadeus API統合完了
2. [ ] アフィリエイトシステム実装
3. [ ] アナリティクス設定

### 来月実施予定
1. [ ] プレミアム機能開発
2. [ ] SEO最適化
3. [ ] マーケティング開始

---

## 📞 サポート・連絡先

このドキュメントに関する質問や提案は、GitHubのIssuesまたはPRでお願いします。

**最終更新**: 2025年7月14日

## 🤖 データ検証用AI収集戦略

### 生成AI活用によるマイルデータ収集

#### 概要
現在のマイル計算の正確性を検証するため、生成AIを活用して実際の特典航空券マイル数データを収集し、比較検証を行う。

#### 収集対象データ
- **国内線**: JAL/ANA特典航空券マイル数（全シーズン）
- **国際線**: 主要路線の特典航空券マイル数
- **シーズン区分**: ピーク/レギュラー/オフシーズンの正確な期間
- **航空会社別マイル差**: 同一路線での航空会社間比較

#### AI収集プロンプト集

##### 1. 国内線マイルデータ収集プロンプト
```
以下の条件で、JALとANAの国内線特典航空券に必要なマイル数を調査してください：

【調査対象路線】
1. 東京（羽田/成田）⇔ 大阪（伊丹/関西）
2. 東京（羽田/成田）⇔ 沖縄（那覇）
3. 東京（羽田/成田）⇔ 札幌（新千歳）
4. 東京（羽田/成田）⇔ 福岡
5. 大阪（伊丹/関西）⇔ 札幌（新千歳）
6. 大阪（伊丹/関西）⇔ 沖縄（那覇）
7. 名古屋（中部）⇔ 沖縄（那覇）
8. 名古屋（中部）⇔ 札幌（新千歳）

【調査項目】
- エコノミークラス特典航空券の必要マイル数
- シーズン別（ピーク/レギュラー/オフ）のマイル数
- 各シーズンの具体的な期間（月日）
- 予約開始時期（搭乗日の何日前から）
- 燃油サーチャージや空港使用料の扱い

【出力形式】
路線ごとに以下の形式でまとめてください：
```
路線: 東京-大阪
JAL:
- オフシーズン: X,XXXマイル（期間：XX月XX日〜XX月XX日）
- レギュラーシーズン: X,XXXマイル（期間：XX月XX日〜XX月XX日）
- ピークシーズン: X,XXXマイル（期間：XX月XX日〜XX月XX日）
- 予約開始: 搭乗日のXX日前
ANA:
- オフシーズン: X,XXXマイル（期間：XX月XX日〜XX月XX日）
- レギュラーシーズン: X,XXXマイル（期間：XX月XX日〜XX月XX日）
- ピークシーズン: X,XXXマイル（期間：XX月XX日〜XX月XX日）
- 予約開始: 搭乗日のXX日前
```

※2024年または2025年の最新データを参照してください
※公式サイトまたは信頼できるマイル情報サイトの情報を元にしてください
```

##### 2. 国際線マイルデータ収集プロンプト
```
以下の条件で、JALとANAの国際線特典航空券に必要なマイル数を調査してください：

【調査対象路線（エコノミークラス）】
1. 東京（成田/羽田）⇔ ロサンゼルス（LAX）
2. 東京（成田/羽田）⇔ ニューヨーク（JFK）
3. 東京（成田/羽田）⇔ ロンドン（LHR）
4. 東京（成田/羽田）⇔ パリ（CDG）
5. 東京（成田/羽田）⇔ ソウル（ICN）
6. 東京（成田/羽田）⇔ 台北（TPE）
7. 東京（成田/羽田）⇔ 香港（HKG）
8. 東京（成田/羽田）⇔ シンガポール（SIN）
9. 東京（成田/羽田）⇔ バンコク（BKK）
10. 大阪（関西）⇔ ソウル（ICN）

【調査項目】
- エコノミークラス往復特典航空券の必要マイル数
- シーズン別のマイル数（ハイ/ロー/ショルダーなど）
- 各シーズンの具体的な期間
- 燃油サーチャージの有無と金額
- 予約開始時期

【出力形式】
各路線について以下の形式で整理してください：
```
路線: 東京-ロサンゼルス（往復・エコノミー）
距離: 約X,XXXkm
JAL:
- ローシーズン: XX,XXXマイル + 諸税XX,XXX円
- レギュラーシーズン: XX,XXXマイル + 諸税XX,XXX円
- ハイシーズン: XX,XXXマイル + 諸税XX,XXX円
ANA:
- ローシーズン: XX,XXXマイル + 諸税XX,XXX円
- レギュラーシーズン: XX,XXXマイル + 諸税XX,XXX円
- ハイシーズン: XX,XXXマイル + 諸税XX,XXX円
```

※2024年または2025年の最新チャートを参照してください
```

##### 3. シーズン区分詳細調査プロンプト
```
JALとANAの特典航空券におけるシーズン区分について、以下の情報を詳細に調査してください：

【調査内容】
1. 国内線のシーズン区分
   - ピークシーズンの具体的期間（開始日〜終了日）
   - レギュラーシーズンの具体的期間
   - オフシーズンの具体的期間

2. 国際線のシーズン区分
   - ハイシーズンの具体的期間
   - レギュラーシーズンの具体的期間
   - ローシーズンの具体的期間

3. 地域別・路線別の違い
   - アジア路線のシーズン区分
   - 北米路線のシーズン区分
   - ヨーロッパ路線のシーズン区分

【出力形式】
```
■ JAL国内線シーズン区分（2025年）
ピークシーズン:
- XX月XX日〜XX月XX日
- XX月XX日〜XX月XX日
- XX月XX日〜XX月XX日

レギュラーシーズン:
- XX月XX日〜XX月XX日
- XX月XX日〜XX月XX日

オフシーズン:
- XX月XX日〜XX月XX日
- XX月XX日〜XX月XX日

■ ANA国内線シーズン区分（2025年）
[同様の形式]

■ JAL国際線シーズン区分（地域別）
アジア路線:
[詳細期間]

北米路線:
[詳細期間]
```

※各航空会社の公式発表資料または信頼できるマイル情報サイトを参考にしてください
```

##### 4. 競合他社マイルデータ収集プロンプト
```
以下の航空会社の日本発着路線における特典航空券マイル数を調査してください：

【調査対象航空会社】
1. スカイマーク（国内線）
2. ピーチ・アビエーション（国内線・アジア路線）
3. ジェットスター・ジャパン（国内線・アジア路線）
4. ソラシドエア（国内線）
5. エアアジア・ジャパン（国内線・アジア路線）

【調査対象路線】
- 主要な国内線路線（東京-大阪、東京-沖縄など）
- アジア路線（成田-ソウル、関西-台北など）

【調査項目】
- 特典航空券制度の有無
- 必要マイル数またはポイント数
- シーズン区分の有無
- 現金との併用制度

【出力形式】
```
■ スカイマーク
特典航空券制度: 有/無
主要路線のマイル数:
- 東京-大阪: X,XXXマイル
- 東京-沖縄: X,XXXマイル
シーズン区分: 有/無

■ ピーチ・アビエーション
[同様の形式]
```

※LCCの場合、独自のポイントシステムの詳細も含めてください
```

#### データ検証手順

1. **AI収集結果の整理**
   - 各プロンプトで得られた情報をスプレッドシートに整理
   - 情報源の信頼性を評価
   - 矛盾する情報がある場合は追加調査

2. **現在のシステムとの比較**
   - 収集した実データと現在のマイル計算結果を比較
   - 差異が大きい路線・シーズンを特定
   - エラー率を算出

3. **データ更新と修正**
   - 実データに基づいてマイルチャートを更新
   - シーズン区分ロジックを修正
   - 再テストで精度向上を確認

#### 継続的データ更新戦略

- **月次更新**: 航空会社の特典航空券チャート変更を追跡
- **シーズン更新**: 年次でシーズン区分の見直し
- **新路線対応**: 新規就航路線の迅速な追加
